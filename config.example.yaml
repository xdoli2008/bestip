# ============================================================
# bestip 配置文件 (YAML 格式)
# ============================================================
#
# 使用说明：
# 1. 复制此文件为 config.yaml 或 config.yml
# 2. 根据需要修改配置项
# 3. 常用配置在前面，高级配置在后面
#
# ============================================================

# ============================================================
# 常用配置（经常需要修改的配置项）
# ============================================================

# ------------------------------------------------------------
# 输出配置
# ------------------------------------------------------------
# 保存的最大结果数量
# 说明：保存到 best.txt 文件中的节点数量
# 范围：1-100
# 推荐：30
max_results: 30

# ------------------------------------------------------------
# 流媒体网站测试配置
# ------------------------------------------------------------
# 是否启用流媒体网站测试
# 说明：测试节点对指定流媒体网站的访问能力
# 可选值：true / false
# 推荐：false（默认关闭，会增加测试时间）
# 影响：每个节点增加 15-30 秒测试时间
enable_streaming_test: false

# 流媒体网站列表
# 说明：要测试的网站列表（可以自定义）
# 格式：完整的 URL（包括 https://）
# 常用网站示例：
#   - https://chatgpt.com
#   - https://www.youtube.com
#   - https://www.netflix.com
#   - https://twitter.com
#   - https://www.instagram.com
#   - https://www.tiktok.com
streaming_sites:
  - https://chatgpt.com
  - https://grok.com
  - https://gemini.google.com
  - https://www.youtube.com

# 流媒体测试超时（秒）
# 范围：5-30，推荐：15
streaming_timeout: 15

# 是否并发测试多个网站
# 推荐：true（显著减少测试时间）
streaming_concurrent: true

# ------------------------------------------------------------
# URL 输入配置（从网络获取测试目标）
# ------------------------------------------------------------
# 是否启用 URL 获取
# 说明：从指定 URL 获取测试目标列表
# 可选值：true / false
# 推荐：false（默认使用本地文件）
enable_url_fetch: false

# URL 列表
# 说明：测试目标列表的 URL（可以添加多个）
# 示例：
#   - https://raw.githubusercontent.com/user/repo/main/list.txt
#   - http://example.com/nodes.txt
url_sources:
  - https://raw.githubusercontent.com/qwer-search/bestip/refs/heads/main/kejilandbestip.txt

# URL 获取超时时间（秒）
# 范围：5-60，推荐：15
url_timeout: 15

# URL 获取失败重试次数
# 范围：0-5，推荐：3
url_retry_times: 3

# 重试间隔（秒）
# 范围：1-10，推荐：1
url_retry_delay: 1

# URL 全部失败时是否回退到文件读取
# 推荐：true（保证即使网络失败也能继续测试）
fallback_to_file: true

# 是否合并文件和 URL 的结果
# 推荐：false（避免重复）
merge_file_and_url: false

# ------------------------------------------------------------
# 自定义文件配置
# ------------------------------------------------------------
# 是否启用自定义文件
# 说明：使用自定义的测试目标文件
# 可选值：true / false
# 推荐：false（默认使用 data/input/testip.txt）
enable_custom_file: false

# 自定义文件路径
# 说明：自定义测试目标文件的路径（相对于项目根目录）
# 格式：支持 IP:端口、域名:端口、IP:端口#别名、域名:端口#别名
custom_file_path: data/input/custom.txt

# 是否合并自定义文件和 URL 结果
# 推荐：true
merge_custom_with_url: true

# 自定义文件优先级
# 可选值：before_url（先处理自定义文件）/ after_url（先处理 URL）
# 推荐：before_url
custom_file_priority: before_url

# ------------------------------------------------------------
# 测试模式配置
# ------------------------------------------------------------
# 测试模式：控制测试的详细程度和速度
# 可选值：
#   - fast: 快速模式
#     * 单轮测试，快速筛选
#     * 适合：快速评估大量节点（100+）
#     * 耗时：最短
#   - balanced: 平衡模式（推荐）
#     * 两轮测试，包含 HTTP 和稳定性测试
#     * 适合：日常使用，中等数量节点（20-100）
#     * 耗时：中等
#   - thorough: 彻底模式
#     * 三轮测试，包含所有测试项
#     * 适合：精确评估少量节点（<20）
#     * 耗时：最长
test_mode: balanced

# ------------------------------------------------------------
# HTTP 性能测试
# ------------------------------------------------------------
# 是否启用 HTTP 性能测试
# 推荐：true（对于代理节点评估很重要）
enable_http_test: true

# HTTP 测试结果是否参与综合评分
# Cloudflare 优选 IP 场景常用：false（只用于展示）
# 代理节点场景常用：true（参与评分）
score_include_http: true

# HTTP 测试 URL
# 说明：用于测试 HTTP 响应速度的 URL
# 推荐值：
#   - https://cp.cloudflare.com/generate_204 (Cloudflare，推荐)
#   - http://www.gstatic.com/generate_204 (Google)
#   - http://captive.apple.com/hotspot-detect.html (Apple)
#   - http://www.msftconnecttest.com/connecttest.txt (Microsoft)
http_test_url: https://cp.cloudflare.com/generate_204

# HTTP 测试超时（秒）
# 范围：5-30，推荐：10
http_timeout: 10

# ============================================================
# 高级配置（一般不需要修改）
# ============================================================

# ------------------------------------------------------------
# 基础测试参数
# ------------------------------------------------------------
# Ping 测试次数
# 范围：1-50，推荐：10（balanced）/ 5（fast）/ 15（thorough）
ping_count: 10

# Ping 超时时间（秒）
# 范围：1-10，推荐：2
ping_timeout: 2

# TCP 连接超时时间（秒）
# 范围：1-30，推荐：5
tcp_timeout: 5

# 并发线程数（第二阶段深度测试）
# 范围：1-50，推荐：10（balanced）/ 20（fast）/ 5（thorough）
# 影响：数值越大测试越快，但可能影响准确性
max_workers: 10

# ------------------------------------------------------------
# 快速检测配置（第一阶段筛选）
# ------------------------------------------------------------
# 是否启用快速检测
# 推荐：true（大幅提高测试效率）
enable_quick_check: true

# 快速检测并发数
# 范围：10-100，推荐：50
quick_check_workers: 50

# 快速检测 Ping 次数
# 范围：1-5，推荐：1
quick_ping_count: 1

# 快速检测 Ping 超时（秒）
# 范围：0.5-5，推荐：1
quick_ping_timeout: 1

# 快速检测 TCP 超时（秒）
# 范围：1-10，推荐：2
quick_tcp_timeout: 2

# ------------------------------------------------------------
# 高级测试配置
# ------------------------------------------------------------
# 是否启用多轮测试
# 推荐：true（提高测试准确性）
enable_multi_round: true

# 测试轮数
# 范围：1-5，推荐：2（balanced）/ 1（fast）/ 3（thorough）
test_rounds: 2

# 异常值过滤方法
# 可选值：
#   - iqr: 四分位距法（推荐，适合大多数场景）
#   - zscore: Z-分数法（适合正态分布的数据）
#   - mad: 中位数绝对偏差法（最稳健，适合有大量异常值的场景）
outlier_filter_method: iqr

# 置信水平
# 范围：0.90-0.99，推荐：0.95（95% 置信水平）
confidence_level: 0.95

# 是否启用智能重试
# 推荐：true（提高测试成功率）
enable_smart_retry: true

# 最大重试次数
# 范围：0-5，推荐：3
max_retries: 3

# ------------------------------------------------------------
# 下载速度测试（可选）
# ------------------------------------------------------------
# 是否启用下载速度测试
# 推荐：false（会显著增加测试时间，每个节点增加 10-30 秒）
enable_download_test: false

# 下载测试文件大小（KB）
# 范围：10-1000，推荐：100
download_test_size_kb: 100

# 下载测试超时（秒）
# 范围：5-60，推荐：10
download_timeout: 10

# ------------------------------------------------------------
# 连接稳定性测试
# ------------------------------------------------------------
# 是否启用连接稳定性测试
# 推荐：true（对于长期使用的节点很重要）
enable_stability_test: true

# 稳定性测试连接次数
# 范围：5-20，推荐：10
stability_attempts: 10

# ------------------------------------------------------------
# 评分模式
# ------------------------------------------------------------
# 评分模式：不同场景使用不同的评分权重
# 可选值：
#   - proxy: 代理模式（推荐）
#     * 适合：代理节点评估
#     * 权重：可用性 20% + 速度 30% + 稳定性 30% + 响应性 20%
#   - vpn: VPN 模式
#     * 适合：VPN 节点评估
#     * 权重：稳定性和速度优先
#   - general: 通用模式
#     * 适合：一般网络质量评估
#     * 权重：延迟和丢包率优先
scoring_mode: proxy

# ============================================================
# 快速配置建议
# ============================================================
#
# 1. 快速测试大量节点（100+）：
#    test_mode: fast
#    max_workers: 20
#    enable_stability_test: false
#    enable_streaming_test: false
#
# 2. 日常使用（推荐）：
#    test_mode: balanced
#    max_workers: 10
#    enable_stability_test: true
#    enable_streaming_test: false
#
# 3. 精确评估少量节点（<20）：
#    test_mode: thorough
#    max_workers: 5
#    enable_stability_test: true
#    enable_download_test: true
#
# 4. 测试流媒体访问能力：
#    enable_streaming_test: true
#    streaming_sites: [添加你关心的网站]
#
# ============================================================
# 输出文件说明
# ============================================================
#
# 测试完成后会生成以下文件：
#
# 1. data/output/result_pro.md
#    - Markdown 格式的详细报告（推荐查看）
#    - 包含所有测试结果和评分
#    - 如果启用流媒体测试，会包含流媒体测试表格
#
# 2. data/output/result_pro.txt
#    - 文本格式的详细报告
#    - 兼容所有编辑器
#
# 3. data/output/best.txt
#    - 干净格式的优质节点列表
#    - 格式：IP:端口#国家代码
#    - 数量由 max_results 控制
#
# 4. data/output/ip.txt
#    - 详细信息的优质节点列表
#    - 包含地理位置别名
#
# ============================================================
