# IP/域名质量批量测试工具

这是一个用于批量测试IP地址和域名质量的Python工具。它会从 `ip.txt` 文件中读取目标列表，测试每个目标的延迟和丢包率，然后按质量排序输出到 `result.txt`。

## 功能特点

- ✅ 批量测试IP地址和域名
- ✅ 计算延迟（ping时间）和丢包率
- ✅ 多线程并发测试，提高效率
- ✅ 按丢包率（升序）和延迟（升序）自动排序
- ✅ 支持Windows系统（自动处理中文/英文系统）
- ✅ 实时显示测试进度和结果
- ✅ 输出格式化的结果文件

## 文件说明

- `ip.txt` - 输入文件，包含要测试的域名和IP列表
- `ip_tester.py` - 主测试程序（Python）
- `run_test.bat` - 批处理脚本，方便运行测试
- `result.txt` - 输出文件，包含排序后的测试结果

## 使用方法

### 方法1：使用批处理脚本（推荐）
1. 确保 `ip.txt` 文件存在并包含要测试的域名/IP
2. 双击 `run_test.bat`
3. 程序会自动运行并显示结果

### 方法2：直接运行Python程序
```bash
python ip_tester.py
```

### 方法3：命令行参数（高级用法）
```bash
# 指定ping次数和超时时间
python ip_tester.py --count 4 --timeout 2

# 指定最大并发数
python ip_tester.py --workers 20
```

## 输入文件格式

`ip.txt` 文件每行一个目标，支持以下格式：

```
# 域名
example.com
www.google.com

# IP地址
8.8.8.8
1.1.1.1

# 带端口的IP（端口会被忽略）
192.168.1.1:8080

# 带注释的目标
104.17.151.112:443#圣何塞-5.60MB/s  # 注释部分会被忽略

# 空行和以#开头的行会被跳过
```

## 输出结果格式

`result.txt` 文件包含以下列：

```
目标                          延迟(ms)       丢包率(%)      状态
----------------------------------------------------------------------
saas.sin.fan                  177.0          0.0            成功
csgo.com                      183.0          0.0            成功
www.visa.com                  192.0          0.0            成功
...
```

结果按以下规则排序：
1. 首先按丢包率升序（丢包率越低越好）
2. 然后按延迟升序（延迟越低越好）

## 配置选项

可以在 `ip_tester.py` 中修改以下参数：

```python
# 每个目标的ping次数（默认：4）
ping_count = 4

# 每次ping的超时时间（秒，默认：2）
timeout = 2

# 最大并发线程数（默认：20）
max_workers = 20
```

## 系统要求

- Python 3.6 或更高版本
- Windows 系统（支持Linux/macOS但需要调整ping命令）
- 网络连接正常

## 故障排除

### 1. Python未安装
```
错误: 未找到Python，请先安装Python 3.x
```
解决方案：从 [python.org](https://www.python.org/downloads/) 下载并安装Python

### 2. ip.txt文件不存在
```
错误: 找不到 ip.txt 文件
```
解决方案：创建 `ip.txt` 文件并添加要测试的目标

### 3. 测试结果不准确
- 增加 `ping_count` 值以获得更准确的平均延迟
- 增加 `timeout` 值以适应网络较慢的目标
- 检查防火墙设置是否允许ICMP流量

### 4. 程序运行缓慢
- 减少 `max_workers` 值以降低系统负载
- 减少 `ping_count` 值以加快测试速度

## 示例

### 测试前显示
```
=======================================================
批量IP/域名质量测试工具
=======================================================
从 ip.txt 读取到 55 个目标
开始测试 55 个目标...
[1/55] saas.sin.fan: 延迟=177.0ms, 丢包=0.0%
[2/55] csgo.com: 延迟=183.0ms, 丢包=0.0%
...
测试完成，成功: 50/55
总测试时间: 45.2秒
```

### 结果摘要
```
======================================================================
前20个最佳结果:
======================================================================
目标                          延迟(ms)       丢包率(%)
----------------------------------------------------------------------
saas.sin.fan                  177.0          0.0
csgo.com                      183.0          0.0
www.visa.com                  192.0          0.0
...
```

## 许可证

本项目使用 MIT 许可证。

## 更新日志

### v1.0.0 (2025-12-17)
- 初始版本发布
- 支持批量测试IP/域名
- 实现延迟和丢包率计算
- 支持多线程并发测试
- 自动排序和结果输出